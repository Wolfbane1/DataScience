
plot(glm$fitted.values)

library(caret)
library(e1071)

glm <- glm(Diabetico~A01AB+A02AD+A02BA+A02BC+A03AB+A03BB+A03FA+A06AC+A06AD+A10AB+A10AC+A10AD+A10AE+A10BA+A10BB+A10BD+A10BF+A10BH+A10BX+A11CA+A11CC+A12AA+A12AX+A12BA+B01AA+B01AB+B01AC+B03AA+B03AB+B03BB+C01DA+C01EB+C02CA+C03AA+C03BA+C03CA+C03DA+C03EA+C03EB+C04AD+C05AA+C05CA+C07AA+C07AB+C07BB+C08CA+C09AA+C09BA+C09CA+C09DA+C09DB+C09DX+C10AA+C10AB+C10AX+C10BA+D01AC+D01AE+D05AX+D06AX+D06BB+D07AA+D07AC+D07AD+D07BC+D10AF+D11AH+G01AF+G03CA+G04BD+G04CA+G04CX+H02AB+H03AA+H03CA+H04AA+J01CA+J01CR+J01DC+J01DD+J01FA+J01MA+J01XE+J01XX+J02AC+J04AC+J05AB+M01AB+M01AC+M01AE+M01AH+M01AX+M02AA+M03BX+M05BA+N01BX+N02AA+N02AX+N02BB+N02BE+N02CC+N03AX+N05BA+N05BB+N05CD+N05CF+N06AA+N06AB+N06AX+N06DX+N07CA+R01AD+R03AC+R03AK+R03BB+R05CB+R05DA+R05DB+R06AB+R06AC+R06AE+R06AX+S01AA+S01AX+S01BC+S01CA+S01ED+S01EE+S01GX+S01XA+S02CA+S03CA+Edad+Sexo, 
           data=m, family=binomial)

f <- formula(Diabetico~A01AB+A02AD+A02BA+A02BC+A03AB+A03BB+A03FA+A06AC+A06AD+A10AB+A10AC+A10AD+A10AE+A10BA+A10BB+A10BD+A10BF+A10BH+A10BX+A11CA+A11CC+A12AA+A12AX+A12BA+B01AA+B01AB+B01AC+B03AA+B03AB+B03BB+C01DA+C01EB+C02CA+C03AA+C03BA+C03CA+C03DA+C03EA+C03EB+C04AD+C05AA+C05CA+C07AA+C07AB+C07BB+C08CA+C09AA+C09BA+C09CA+C09DA+C09DB+C09DX+C10AA+C10AB+C10AX+C10BA+D01AC+D01AE+D05AX+D06AX+D06BB+D07AA+D07AC+D07AD+D07BC+D10AF+D11AH+G01AF+G03CA+G04BD+G04CA+G04CX+H02AB+H03AA+H03CA+H04AA+J01CA+J01CR+J01DC+J01DD+J01FA+J01MA+J01XE+J01XX+J02AC+J04AC+J05AB+M01AB+M01AC+M01AE+M01AH+M01AX+M02AA+M03BX+M05BA+N01BX+N02AA+N02AX+N02BB+N02BE+N02CC+N03AX+N05BA+N05BB+N05CD+N05CF+N06AA+N06AB+N06AX+N06DX+N07CA+R01AD+R03AC+R03AK+R03BB+R05CB+R05DA+R05DB+R06AB+R06AC+R06AE+R06AX+S01AA+S01AX+S01BC+S01CA+S01ED+S01EE+S01GX+S01XA+S02CA+S03CA+Edad+Sexo)


svmc <- svm(f, data=m)
p <- suppressWarnings(predict(svmc, newdata=m12))

summary(svmc)


#Evaluamos el resultado y validamos con 2012.
r <- ifelse(glm$fitted.values<=0.5, 0, 1)
p <- suppressWarnings(predict.glm(glm, newdata=m12, type="response"))
r12 <- ifelse(p <= 0.5, 0, 1)
plot(tabla <- table(r, r12))
p

r12 <- ifelse(p <= 0, 0, 1)
prob <- r12
real <- m12$Diabetico

table(prob, real)

t <- as.data.frame(cbind(prob, real))

t0 <- subset(t, t$real==0)
t1 <- subset(t, t$real==1)

plot(t0$prob, type="h")
plot(t1$prob, type="h")

barplot(t0$prob)


#####Poner.











 